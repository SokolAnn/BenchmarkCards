# FormAI dataset

## üìä Benchmark Details

**Name**: FormAI dataset

**Overview**: A large collection of 112,000 AI-generated compilable and independent C programs with vulnerability classification produced by GPT-3.5-turbo and labeled using formal verification (ESBMC). The dataset provides per-program vulnerability labels (type, line number, function name) and mappings to Common Weakness Enumeration (CWE) identifiers, intended for evaluating static/dynamic analysis tools and training machine learning models.

**Data Type**: text (compilable C programs / C source code)

**Domains**:
- Software Engineering
- Cybersecurity

**Similar Benchmarks**:
- Big-Vul
- Draper
- SARD
- Juliet
- Devign
- REVEAL
- DiverseVul

**Resources**:
- [GitHub Repository](https://github.com/FormAI-Dataset)
- [Resource](https://doi.org/10.1145/3617555.3617874)
- [Resource](https://arxiv.org/abs/2307.02192)

## üéØ Purpose and Intended Users

**Goal**: Provide a large AI-generated dataset of 112,000 compilable C programs labeled via formal verification (ESBMC) to benchmark vulnerability detection tools and to train machine learning models for vulnerability detection and classification.

**Target Audience**:
- Machine Learning Researchers
- Software Security Researchers
- Tool Developers
- Model Developers

**Tasks**:
- Vulnerability Detection
- Vulnerability Classification
- Static Analysis Evaluation
- Machine Learning Model Training for Code Vulnerability Detection

**Limitations**: ESBMC detects only formally verifiable errors within a predefined bound; absence of a detected vulnerability means 'no vulnerability within the bound' rather than absolute absence. The authors used ESBMC with --unwind 1 and --timeout 30 seconds; samples where ESBMC timed out or crashed are classified as unknown or excluded from CSV labels. ESBMC cannot detect design flaws, semantic errors, or performance issues. Some ESBMC-reported line numbers (e.g., for gets()) were misleading and excluded from CSVs. A subset of samples (‚âà1% for clang compilation; additional samples where ESBMC crashed) were not classified.

## üíæ Data

**Source**: Generated by GPT-3.5-turbo using a dynamic zero-shot prompting technique; compilability checked with the GNU C compiler; vulnerabilities labeled using the ESBMC bounded model checker.

**Size**: 112,000 examples (C programs); 8,848,765 total lines of code examined; average 79 lines per sample. 109,757 samples compiled with gcc (~98%). Verification executed on 106,139 files; 57,389 programs found vulnerable; 197,800 vulnerabilities detected.

**Format**: C source files (.c) and CSV files (.csv) containing labels (Filename, Vulnerability type, Function name, Line number, Error type) and an additional CSV with the C code in a column.

**Annotation**: Automatically annotated via ESBMC (Efficient SMT-based Bounded Model Checker). Labels include vulnerability type, vulnerable function name, and line number. Identified vulnerabilities were associated with CWE identifiers. Only labels where ESBMC finished within the configured timeout (30 seconds) and unwind settings were kept; some ESBMC outputs (misleading line numbers for external library code) were excluded from CSVs.

## üî¨ Methodology

**Methods**:
- Formal verification (ESBMC bounded model checking)
- Compilation check using GNU C compiler (gcc)
- Automated labeling via ESBMC with timeout/unwind settings

**Metrics**:
- Count of vulnerable programs
- Percentage of programs vulnerable
- Number of vulnerabilities detected
- Distribution of vulnerabilities across CWE identifiers

**Calculation**: Programs classified into three categories by ESBMC output: VS (verification successful: 'NOT VULNERABLE up to bound k'), VU (verification unknown: timed out or incomplete), VF (verification failed: counterexample found). A program is 'vulnerable' if ESBMC produces a counterexample within the allotted timeout and unwind settings. Verification run with: --unwind 1 --overflow --multi-property --timeout 30.

**Interpretation**: N/A

**Validation**: Compilability validated using GNU C compiler; formal verification via ESBMC provides counterexamples for detected vulnerabilities, eliminating false positives within the verification bound. The authors retained only ESBMC labels where the verifier finished within 30 seconds; samples causing ESBMC crashes or clang compilation failures were excluded from the CSV labels but kept in the dataset.

## ‚ö†Ô∏è Targeted Risks

**Risk Categories**:
- Security
- Safety
- Robustness
- Accuracy

**Atlas Risks**:
- **Accuracy**: Unrepresentative data, Poor model accuracy
- **Robustness**: Hallucination
- **Governance**: Lack of testing diversity
- **Transparency**: Uncertain data provenance
- **Value Alignment**: Harmful code generation

**Potential Harm**: Detection of software vulnerabilities affecting safety and security properties of C programs (e.g., buffer overflows, integer overflow/arithmetic overflow, array bounds violations, null pointer dereferences, division by zero, memory management errors).

## üîí Ethical and Legal Considerations

**Privacy And Anonymity**: Not Applicable

**Data Licensing**: Not Applicable

**Consent Procedures**: Not Applicable

**Compliance With Regulations**: Not Applicable
